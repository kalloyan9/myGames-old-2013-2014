var requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(a){setTimeout(a,1E3/30)},c=document.getElementById("canvas-id");c.width=900;c.height=600;var d=c.getContext("2d"),e=[],f=new Image;f.src="background.png";var g=!1,h=40,k=250,l=new Image;l.src="TaShip.png";var m=1E3,n=0,p=0,q=!1,r,s,t=0,u,v=new Image;v.src="explosion.png";var w=u=0,x=[],y=[],z=0,A=200,B=[],C=[],D=0,E=0,F=new Image;
F.src="enemy1.png";var G=[],H=[],I=[],J=0,K=0,aa=new Image;aa.src="enemy2.png";var L=[],M=[],N=[],O=0,P=0,ba=new Image;ba.src="enemy3.png";var Q=[],R=[],S=[],ca=0,T=0,da=new Image;da.src="asteroid.png";var U=[],V=[],W=[],X=[],ea=0,Y=0,fa=100,ga=new Image;ga.src="asteroid2.png";var fa=100,Z=[],$=[],p=n=0;window.addEventListener("keydown",function(a){e[a.keyCode]=!0},!1);window.addEventListener("keyup",function(a){e[a.keyCode]=!1},!1);window.addEventListener("mousemove",function(){},!1);
function ha(){0>=m&&(g=!0);e[87]&&5<k&&(k-=4);e[83]&&k+80<c.height&&(k+=4);e[65]&&18<h&&(h-=4);e[68]&&h+125<c.width&&(h+=4);e[32]&&150<z&&0<A-w?(x[w]=h+120,y[w]=k+36,w++,z=0):170>z&&(z+=20);for(var a=0;a<w;a++)x[a]+=8;0==D%260&&(C[E]=Math.random()*c.height,100>=C[E]&&(C[E]=400),C[E]>=c.height-100&&(C[E]=400),B[E]=c.width,G[E]=100,E++);D+=.5;for(a=0;a<E;a++)B[a]-=1.5,0>=G[a]&&(n+=40,p+=40,q=!0,t=1,r=B[a],s=C[a],delete B[a],delete C[a],delete G[a]),0>B[a]+80&&(70<n?(n-=70,p-=70):p=n=0,delete B[a],delete C[a],
delete G[a]);for(a=0;a<E;a++)h+120>=B[a]&&h<=B[a]+100&&k+80>=C[a]&&k<=C[a]+60&&(q=!0,t=1,r=B[a],s=C[a],m-=450,10<n&&(n-=10,p-=10),G[a]=0);0==J%240&&(I[K]=Math.random()*c.height-700,100>=I[K]&&(I[K]=400),I[K]>=c.height-100&&(I[K]=400),B[E]=c.width,H[K]=c.width,L[K]=100,K++);J+=.5;for(a=0;a<K;a++)H[a]-=2,H[a]>h+120&&(k>I[a]&&700>H[a]&&(I[a]+=1.5),k<I[a]&&700>H[a]&&(I[a]-=1.5)),0>=L[a]&&(n+=60,p+=60,q=!0,t=2,r=H[a],s=I[a],delete H[a],delete I[a],delete L[a]),0>H[a]+80&&(90<n?(n-=90,p-=90):p=n=0,delete H[a],
delete I[a],delete L[a]);for(a=0;a<K;a++)h+120>=H[a]&&h<=H[a]+100&&k+80>=I[a]&&k<=I[a]+60&&(q=!0,t=2,r=H[a],s=I[a],m-=560,20<n&&(n-=20,p-=20),L[a]=0);0==O%400&&(N[P]=Math.random()*c.height-200,100>=N[P]&&(N[P]=400),N[P]>=c.height-100&&(N[P]=400),M[P]=c.width,Q[P]=500,P++);O+=.5;for(a=0;a<P;a++)M[a]-=.7,0>=Q[a]&&(n+=120,p+=120,q=!0,t=3,r=M[a],s=N[a],delete M[a],delete N[a],delete Q[a]),0>M[a]+80&&(70<n?(n-=140,p-=140):p=n=0,delete M[a],delete N[a],delete Q[a]);for(a=0;a<P;a++)h+120>=M[a]&&h<=M[a]+
119&&k+80>=N[a]&&k<=N[a]+79&&(70<n?(n-=70,p-=70):p=n=0,q=!0,t=3,r=M[a],s=N[a],m=-1,Q[a]=0);3>T&&(0==ca%100&&(S[T]=-80,R[T]=Math.random()*c.width,V[T]=200,U[T]=R[T]>c.width/2?-2:2,T++),ca++);for(a=0;a<T;a++)if(S[a]+=2,R[a]+=U[a],R[a]>c.width||0>R[a]+80||S[a]>c.height)R[a]=Math.random()*c.width,S[a]=-80,V[a]=200,U[T]=R[T]>c.width/2?2:-2;3>Y&&(0==ea%fa&&(X[Y]=c.height+80,W[Y]=Math.random()*c.width,$[Y]=200,Z[Y]=W[Y]>c.width/2+100?-3:3,Y++),ea++);for(a=0;a<Y;a++)if(X[a]-=2,W[a]+=Z[a],W[a]>c.width||0>
W[a]+80||0>X[a])W[a]=Math.random()*c.width,X[a]=c.height,$[a]=200,Z[Y]=W[Y]>c.width/2+100?-3:3;for(a=0;a<T;a++)20>=V[a]&&(R[a]=Math.random()*c.width,S[a]=-80,V[a]=200);for(a=0;a<Y;a++)20>=$[a]&&(W[a]=Math.random()*c.width,X[a]=-80,$[a]=200);for(a=0;a<w;a++)for(var b=0;b<E;b++)x[a]+7>=B[b]&&x[a]<=B[b]+100&&y[a]+7>=C[b]&&y[a]<=C[b]+60&&(G[b]-=14,delete x[a],delete y[a]);for(a=0;a<w;a++)for(b=0;b<K;b++)x[a]+7>=H[b]&&x[a]<=H[b]+100&&y[a]+7>=I[b]&&y[a]<=I[b]+60&&(L[b]-=10,delete x[a],delete y[a]);for(a=
0;a<w;a++)for(b=0;b<P;b++)x[a]+7>=M[b]&&x[a]<=M[b]+120&&y[a]+7>=N[b]&&y[a]<=N[b]+80&&(Q[b]-=20,delete x[a],delete y[a]);for(a=0;a<w;a++)for(b=0;b<T;b++)x[a]+7>=R[b]&&x[a]<=R[b]+70&&y[a]+7>=S[b]&&y[a]<=S[b]+60&&(V[b]-=70,delete x[a],delete y[a]);for(a=0;a<w;a++)for(b=0;b<Y;b++)x[a]+7>=W[b]&&x[a]<=W[b]+70&&y[a]+7>=X[b]&&y[a]<=X[b]+60&&($[b]-=70,delete x[a],delete y[a]);1E3>m&&(m+=.3);1E3<D&&(D=0);1E3<J&&(J=0);1E3<O&&(O=0);for(a=0;a<T;a++)h+120>=R[a]&&h<=R[a]+70&&k+80>=S[a]&&k<=S[a]+60&&(m-=400,V[a]=
0);for(a=0;a<Y;a++)h+120>=W[a]&&h<=W[a]+70&&k+80>=X[a]&&k<=X[a]+60&&(m-=400,$[a]=0);n+=.009;p+=.009;500<=p&&(A+=100,p=0);q&&(u++,15<=u&&(u=0,t=q=!1));setTimeout(ha,15)}
function ia(){d.clearRect(0,0,c.width,c.height);d.globalAlpha=1;d.drawImage(f,0,0,c.width,c.height);if(g)d.font="40px Comic Sans MS",d.fillText("GAME OVER, press F5 to restart!",c.width/2-325,c.height/2);else{0>=A-w&&(d.font="40px Comic Sans MS",d.fillText("OUT OF BULLETS!!!",c.width/2-325,c.height/2));d.fillStyle="red";for(var a=0;a<E;a++)0<B[a]+80&&G&&(d.drawImage(F,B[a],C[a],100,60),d.fillRect(B[a]+105,C[a]-20,10,G[a]));d.fillStyle="red";for(a=0;a<K;a++)0<H[a]+80&&L&&(d.drawImage(aa,H[a],I[a],
100,60),d.fillStyle="red",d.fillRect(H[a]+105,I[a]-20,10,L[a]));d.fillStyle="red";for(a=0;a<P;a++)0<M[a]+80&&Q&&(d.drawImage(ba,M[a],N[a],120,80),d.fillRect(M[a]+127,N[a]-10,10,Q[a]/5));d.fillStyle="red";for(a=0;a<w;a++)d.fillStyle="#ef0b3a",x[a]-10<c.width+10?(d.beginPath(),d.arc(x[a],y[a],5,0,2*Math.PI),d.closePath(),d.fill()):(delete x[a],delete y[a]);q&&(1==t&&d.drawImage(v,50*u,0,50,51,r,s,90,90),2==t&&d.drawImage(v,50*u,0,50,51,r,s,100,100),3==t&&d.drawImage(v,50*u,0,50,51,r-7,s-10,120,120));
d.drawImage(l,h,k,120,80);d.fillStyle="red";d.fillRect(h-12,k-10,10,m/10);for(a=0;a<T;a++)d.drawImage(da,R[a],S[a],70,60);for(a=0;a<Y;a++)d.drawImage(ga,W[a],X[a],70,60);d.fillStyle="LawnGreen";d.font="20px Comic Sans MS";d.fillText("Bullets: "+(A-w),10,50);d.fillText("Score: "+Math.floor(n),700,50)}requestAnimationFrame(ia)}ha();ia();